
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>2.5 [FV] Sections Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="26_[capsule]_sections.html" />
    
    
    <link rel="prev" href="24_[fd]_sections.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../#edk-ii-flash-description-fdf-file-specification">
            
                    
                    EDK II Flash Description (FDF) File Specification
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../1_introduction/">
            
                <a href="../1_introduction/#1-introduction">
            
                    
                    1 Introduction
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../1_introduction/11_overview.html">
            
                <a href="../1_introduction/11_overview.html#11-overview">
            
                    
                    1.1 Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../1_introduction/12_terms.html">
            
                <a href="../1_introduction/12_terms.html#12-terms">
            
                    
                    1.2 Terms
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../1_introduction/13_related_information.html">
            
                <a href="../1_introduction/13_related_information.html#13-related-information">
            
                    
                    1.3 Related Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../1_introduction/14_target_audience.html">
            
                <a href="../1_introduction/14_target_audience.html#14-target-audience">
            
                    
                    1.4 Target Audience
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../1_introduction/15_conventions_used_in_this_document.html">
            
                <a href="../1_introduction/15_conventions_used_in_this_document.html#15-conventions-used-in-this-document">
            
                    
                    1.5 Conventions Used in this Document
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="./">
            
                <a href="./#2-fdf-design-discussion">
            
                    
                    2 FDF Design Discussion
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="21_processing_overview.html">
            
                <a href="21_processing_overview.html#21-processing-overview">
            
                    
                    2.1 Processing Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="22_flash_description_file_format.html">
            
                <a href="22_flash_description_file_format.html#22-flash-description-file-format">
            
                    
                    2.2 Flash Description File Format
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="23_[defines]_section.html">
            
                <a href="23_[defines]_section.html#23-defines-section">
            
                    
                    2.3 [Defines] Section
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="24_[fd]_sections.html">
            
                <a href="24_[fd]_sections.html#24-fd-sections">
            
                    
                    2.4 [FD] Sections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="25_[fv]_sections.html">
            
                <a href="25_[fv]_sections.html#25-fv-sections">
            
                    
                    2.5 [FV] Sections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="26_[capsule]_sections.html">
            
                <a href="26_[capsule]_sections.html#26-capsule-sections">
            
                    
                    2.6 [Capsule] Sections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="27_[vtf]_sections.html">
            
                <a href="27_[vtf]_sections.html#27-vtf-sections">
            
                    
                    2.7 [VTF] Sections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="28_[rule]_sections.html">
            
                <a href="28_[rule]_sections.html#28-rule-sections">
            
                    
                    2.8 [Rule] Sections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="29_[optionrom]_sections.html">
            
                <a href="29_[optionrom]_sections.html#29-optionrom-sections">
            
                    
                    2.9 [OptionRom] Sections
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../3_edk_ii_fdf_file_format/">
            
                <a href="../3_edk_ii_fdf_file_format/#3-edk-ii-fdf-file-format">
            
                    
                    3 EDK II FDF File Format
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../3_edk_ii_fdf_file_format/31_general_rules.html">
            
                <a href="../3_edk_ii_fdf_file_format/31_general_rules.html#31-general-rules">
            
                    
                    3.1 General Rules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../3_edk_ii_fdf_file_format/32_fdf_definition.html">
            
                <a href="../3_edk_ii_fdf_file_format/32_fdf_definition.html#32-fdf-definition">
            
                    
                    3.2 FDF Definition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../3_edk_ii_fdf_file_format/33_header_section.html">
            
                <a href="../3_edk_ii_fdf_file_format/33_header_section.html#33-header-section">
            
                    
                    3.3 Header Section
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../3_edk_ii_fdf_file_format/34_[defines]_section.html">
            
                <a href="../3_edk_ii_fdf_file_format/34_[defines]_section.html#34-defines-section">
            
                    
                    3.4 [Defines] Section
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../3_edk_ii_fdf_file_format/35_[fd]_sections.html">
            
                <a href="../3_edk_ii_fdf_file_format/35_[fd]_sections.html#35-fd-sections">
            
                    
                    3.5 [FD] Sections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../3_edk_ii_fdf_file_format/36_[fv]_sections.html">
            
                <a href="../3_edk_ii_fdf_file_format/36_[fv]_sections.html#36-fv-sections">
            
                    
                    3.6 [FV] Sections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../3_edk_ii_fdf_file_format/37_[capsule]_sections.html">
            
                <a href="../3_edk_ii_fdf_file_format/37_[capsule]_sections.html#37-capsule-sections">
            
                    
                    3.7 [Capsule] Sections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../3_edk_ii_fdf_file_format/38_[fmppayload]_sections.html">
            
                <a href="../3_edk_ii_fdf_file_format/38_[fmppayload]_sections.html#38-fmppayload-sections">
            
                    
                    3.8 [FmpPayload] Sections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="../3_edk_ii_fdf_file_format/39_[rule]_sections.html">
            
                <a href="../3_edk_ii_fdf_file_format/39_[rule]_sections.html#39-rule-sections">
            
                    
                    3.9 [Rule] Sections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="../3_edk_ii_fdf_file_format/310_[vtf]_section.html">
            
                <a href="../3_edk_ii_fdf_file_format/310_[vtf]_section.html#310-vtf-section">
            
                    
                    3.10 [VTF] Section
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.11" data-path="../3_edk_ii_fdf_file_format/311_pci_optionrom_section.html">
            
                <a href="../3_edk_ii_fdf_file_format/311_pci_optionrom_section.html#311-pci-optionrom-section">
            
                    
                    3.11 PCI OptionRom Section
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../appendix_a_nt32pkg_flash_description_file.html">
            
                <a href="../appendix_a_nt32pkg_flash_description_file.html#appendix-a-nt32pkg-flash-description-file">
            
                    
                    Appendix A Nt32Pkg Flash Description File
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../appendix_b_common_error_messages.html">
            
                <a href="../appendix_b_common_error_messages.html#appendix-b-common-error-messages">
            
                    
                    Appendix B Common Error Messages
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../appendix_b_common_error_messages.html">
            
                <a href="../appendix_b_common_error_messages.html#b1-fd-syntax-errors">
            
                    
                    B.1 [FD] Syntax Errors:
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../appendix_b_common_error_messages.html">
            
                <a href="../appendix_b_common_error_messages.html#b2-fv-syntax-errors">
            
                    
                    B.2 [FV] Syntax Errors:
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../appendix_b_common_error_messages.html">
            
                <a href="../appendix_b_common_error_messages.html#b3-capsule-syntax-errors">
            
                    
                    B.3 [CAPSULE] Syntax Errors:
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../appendix_b_common_error_messages.html">
            
                <a href="../appendix_b_common_error_messages.html#b4-rule-syntax-errors">
            
                    
                    B.4 [Rule] Syntax Errors:
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../appendix_c_reports.html">
            
                <a href="../appendix_c_reports.html#appendix-c-reports">
            
                    
                    Appendix C Reports
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" >
            
                <span>
            
                    
                    Tables
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../1_introduction/11_overview.html">
            
                <a href="../1_introduction/11_overview.html#table-1-edk-build-infrastructure-support-matrix">
            
                    
                    Table 1 EDK Build Infrastructure Support Matrix
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="22_flash_description_file_format.html">
            
                <a href="22_flash_description_file_format.html#table-2-well-known-macro-statements">
            
                    
                    Table 2 Well-known Macro Statements
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="22_flash_description_file_format.html">
            
                <a href="22_flash_description_file_format.html#table-3-using-system-environment-variable">
            
                    
                    Table 3 Using System Environment Variable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="22_flash_description_file_format.html">
            
                <a href="22_flash_description_file_format.html#table-4-reserved-rule-section-macro-strings">
            
                    
                    Table 4 Reserved [Rule] Section Macro Strings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5" data-path="22_flash_description_file_format.html">
            
                <a href="22_flash_description_file_format.html#table-5-operator-precedence-and-supported-operands">
            
                    
                    Table 5 Operator Precedence and Supported Operands
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" >
            
                <span>
            
                    
                    Figures
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="21_processing_overview.html">
            
                <a href="21_processing_overview.html#figure-1-edk-ii-build-data-flow">
            
                    
                    Figure 1 EDK II Build Data Flow
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="21_processing_overview.html">
            
                <a href="21_processing_overview.html#figure-2-edk-ii-create-image-flow">
            
                    
                    Figure 2 EDK II Create Image Flow
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" >
            
                <span>
            
                    
                    Examples
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../3_edk_ii_fdf_file_format/32_fdf_definition.html">
            
                <a href="../3_edk_ii_fdf_file_format/32_fdf_definition.html#example-edk-ii-fdf">
            
                    
                    Example (EDK II FDF)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >2.5 [FV] Sections</a>
    </h1>
</div>
<div>
    <!-- 
    <img style="float:left; align:middle; height:2em" src="media/TianocoreTitlePageLogo.jpg"/>
     -->
    
      <h2>
        <div style="position:absolute;text-align:left">EDK II Flash Description (FDF) File Specification</div>
        <div style="text-align:right">Revision 1.28.01</div>
      </h2>  
    
    <hr>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
                                <section class="normal markdown-section">
                                
                                <!--- @file
  2.5 [FV] Sections

  Copyright (c) 2006-2017, Intel Corporation. All rights reserved.<BR>

  Redistribution and use in source (original document form) and 'compiled'
  forms (converted to PDF, epub, HTML and other formats) with or without
  modification, are permitted provided that the following conditions are met:

  1) Redistributions of source code (original document form) must retain the
     above copyright notice, this list of conditions and the following
     disclaimer as the first lines of this file unmodified.

  2) Redistributions in compiled form (transformed to other DTDs, converted to
     PDF, epub, HTML and other formats) must reproduce the above copyright
     notice, this list of conditions and the following disclaimer in the
     documentation and/or other materials provided with the distribution.

  THIS DOCUMENTATION IS PROVIDED BY TIANOCORE PROJECT "AS IS" AND ANY EXPRESS OR
  IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
  MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO
  EVENT SHALL TIANOCORE PROJECT  BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
  OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
  OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS DOCUMENTATION, EVEN IF
  ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

-->
<h2 id="25-fv-sections">2.5 [FV] Sections</h2>
<p>The <code>[FV]</code> sections are required for platform images, are optional for Capsule
images, and are not required for Option ROM only images. The <code>[FV]</code> section
defines what components or modules are placed within a flash device file. These
sections define the order the components and modules are positioned within the
image. The <code>[FV]</code> section consists of define statements, set statements and
module statements. A single <code>[FV]</code> section is terminated by the start of
another section header or the end of the file. The <code>[FV]</code> section has one
required modifier, a user defined section name. The format for <code>[FV]</code> section
header is:</p>
<p><code>[FV.UiFvName]</code></p>
<p>The FV <code>UiFvName</code> must be unique for every declared user defined name within
the file. The <code>UiFvName</code> is used for specifying the file that will be used in
and <code>[FD]</code> section.</p>
<p>Nesting of <code>[FV]</code> sections is permitted, making it possible to create a tree
structure containing multiple FV sections within a single <code>[FV]</code> section. Nested
sections are specified using either the syntax &quot;FILE FV_IMAGE = Name&quot; or
&quot;SECTION FV_IMAGE = Name&quot; within the top <code>[FV]</code> Section.</p>
<p>Use of the <code>UiFvName</code> modifier permits the user to include, by <code>UiFvName</code>,
previously defined sections within another FV section. This eliminates the need
to re-specify components or modules in multiple places. When the <code>FvNameString</code>
entry is present and set to TRUE in an <code>[FV]</code> section, the tools will generate
an <code>FvNameString</code> entry in FV EXT header using the <code>UiFvName</code>.</p>
<p>This section also specifies how to define content for PI FV Extensions which
provides a mapping for a GUID, an OEM file type and FV used size. The size of
<code>EFI_FIRMWARE_VOLUME_EXT_HEADER</code> and <code>EFI_FIRMWARE_VOLUME_EXT_ENTRY</code> sizes will
be calculated based on content, while the <code>EFI_FIRMWARE_VOLUME_EXT_ENTRY</code> type
must be defined by the platform integrator based on the PI specification,
volume 3 The content is limited to the contents of a binary file specified by a
FILE statement or a data array specified by a <code>DATA</code> statement.</p>
<p>The <code>EFI_FIRMWARE_VOLUME_EXT_ENTRY_OEM_TYPE</code> (using <code>TYPE=0x0001</code>) is only
support by including a file or data structure that completes the remainder of
the OEM type entry, where the first entry would have to be a <code>UINT32</code>
representing the TypeMask. Additional types defined by the PI spec will be
supported in this manner as well.</p>
<p>The build system permits a recovery feature that allows placing two copies of a
<code>PEI.fv</code> in the flash top. If the top one is corrupt, backup one will be
swapped to the top and work.</p>
<p>The backup must be the same as the top <em>PEI.fv</em> although it is placed into
another place. Therefore, the backup FV must be rebased to run at another
address. The <code>FvBaseAddress</code> and the optional <code>FvForceRebase</code> attributes must be
above <code>FvAlignment</code> attribute.</p>
<h3 id="251-define-statements">2.5.1 DEFINE Statements</h3>
<p><code>DEFINE</code> statements are used to define Macro definitions that are scoped to the
individual <code>[FV]</code> sections. <code>DEFINE</code> statements are processed in order, so a
later <code>DEFINE</code> statement for a given <code>MACRO</code> over-writes the previous definition
for the remainder of the section or sub-section. The <code>DEFINE</code> statements are
typically used for creating short-cut names for directory path names, but may be
used for identifying other items or values that will be used in later statements.</p>
<p><code>DEFINE MACRO = VALUE</code></p>
<p>The following are examples of the <code>DEFINE</code> statement.</p>
<pre><code>DEFINE EDKMOD           = $(WORKSPACE)/EdkModulePkg/
DEFINE MDE_MOD_TSPG     = gEfiMdeModulePkgTokenSpaceGuid
DEFINE NV_STOR_VAR_SIZE = PcdFlashNvStorageVariableSize
DEFINE FV_HDR_SIZE      = 0x48
DEFINE VAR_STORE_SIZE   = $(MDE_MOD_TSPG).$(NV_STOR_VAR_SIZE) - $(FV_HDR_SIZE)
</code></pre><h3 id="252-block-statements">2.5.2 Block Statements</h3>
<p><code>BLOCK</code> statements are used to define block size and the number of blocks that
are needed for FV images that do NOT get put into a physical flash part, such
as the recovery image that gets put on a floppy or USB key.</p>
<pre><code>BLOCK_SIZE = VALUE
NUM_BLOCKS = VALUE
</code></pre><p>The following is an example of the BLOCK statement:</p>
<p><code>BLOCK_SIZE = 512</code></p>
<h3 id="253-fv-set-statements">2.5.3 FV SET Statements</h3>
<p><code>SET</code> statements are used to define the values of PCDs. These statements are
positional within the FDF file. <code>SET</code> statements set a <code>PcdName</code> to a <code>VALUE</code>
for this FV.</p>
<p><code>SET &lt;PcdName&gt; = VALUE</code></p>
<p>The following is an example of the <code>SET</code> statement:</p>
<p><code>SET gEfiMyTokenSpaceGuid.PcdDisableOnboardVideo = TRUE</code></p>
<p>The <code>VALUE</code> specified must match the Pcd&apos;s datum type and must be the content
data.</p>
<p>For a PCD that has a datum type of <code>VOID</code>*, the data can be a Unicode string,
as in <code>L&quot;text&quot;</code>, a valid C data array (it must be either a C format GUID or a
hex byte array), as in <code>{0x20, 0x00, 0x20, 0x00, 0x32, 0xFF, 0x00, 0xAA, {0xFF, 0xF0, 0x00, 0x00, 0x00}}.</code>
Other PCD datum types are either boolean values or a hex value, as in
<code>0x0000000F</code>, with a value that is consistent with the PCD&apos;s datum type</p>
<p>The value may also be a macro or it may be computed, using arithmetic
operations, arithmetic expressions and or logical expressions. The value
portion of the <code>SET</code> statement, when using any of these computations are in-fix
expressions that are evaluated left to right, with items within parenthesis
evaluated before the outer expressions are evaluated. Use of parenthesis is
encouraged to remove ambiguity.</p>
<h3 id="254-apriori-scoping">2.5.4 APRIORI Scoping</h3>
<p>Within some firmware volumes, an <code>APRIORI</code> file can be created which is a GUID
named list of modules in the firmware volume. The modules will be invoked or
dispatched in the order they appear in the <code>APRIORI</code> file. Within a Firmware
Volume, only one PEI and one DXE Apriori file are permitted. Since nested
Firmware Volumes are permitted, Apriori files are limited to specifying the
files, not FVs that are within the scope of the FV image in which it is
located. (It is permissible for nested FV images to have one PEI and one DXE
Apriori file per FV.) Scoping is accomplished using the curly &quot;{}&quot; braces.</p>
<p>The following example demonstrates an example of multiple APRIORI files.</p>
<pre><code class="lang-ini">[Fv.Root]
  DEFINE NT32     = $(WORKSPACE)/EdkNt32Pkg
  DEFINE BuildDir = $(OUTPUT_DIRECTORY)/$(PLATFORM_NAME)/$(TARGET)_$(TOOL_CHAIN_TAG)
  APRIORI DXE {
    FILE DXE_CORE = B5596C75-37A2-4b69-B40B-72ABD6DD8708 {
      SECTION COMPRESS {
        SECTION PE32 = $(BuildDir)/X/Y/Z/B5596C75-37A2-4b69-B40B-72ABD6DD8708-DxeCore.efi
        SECTION VERSION &quot;1.2.3&quot;
      }
    }
    INF VERSION = &quot;1&quot; ${NT32)/Dxe/WinNtThunk/Cpu/Cpu.inf
  }

  FILE FV_IMAGE = EF41A0E1-40B1-481f-958E-6FB4D9B12E76 {
    SECTION GUIDED 3EA022A4-1439-4ff2-B4E4-A6F65A13A9AB {
      SECTION FV_IMAGE = Dxe {
        APRIORI DXE {
          INF a/a/a.inf
          INF a/c/c.inf
          INF a/b/b.inf
        }
        INF a/d/d.inf
        ...
      }
    }
  }
</code></pre>
<p>In the example above, There are three FFS files in the <code>Fv.Root</code> and one
Encapsulated FV image, with the build tools creating an <code>APRIORI</code> file that
will dispatch the <code>DXE_CORE</code> first, then the CPU module second. In the FV
image, named Dxe, there will be at least five FFS files, the <code>APRIORI</code> file,
listing the GUID names of <code>a.inf</code>, <code>c.inf</code> and <code>b.inf</code>, which will be
dispatched in this order. Once complete, the <code>d.inf</code> module will be dispatched.</p>
<h3 id="255-inf-statements">2.5.5 INF Statements</h3>
<p>The INF statements point to EDK component and EDK II module INF files. Parsing
tools will scan the INF file to determine the type of component or module. The
component or module type is used to reference the standard rules defined
elsewhere in the FDF file.</p>
<p>The format for INF statements is:</p>
<p><code>INF [Options] PathAndInfFileName</code></p>
<p>The <code>PathAndInfFileName</code> is the <code>WORKSPACE</code> (or <code>PACKAGES_PATH</code>)relative path
and filename.</p>
<p>Using an INF statement will cause the build tools to implicitly build an FFS
file with the <code>EFI_FV_FILETYPE</code> based on the INF module&apos;s <code>MODULE_TYPE</code> and
content. For example, specifying the following lines in an FV section will
generate an FFS file with an <code>EFI_FV_FILETYPE_DRIVER</code> with three sections, the
<code>EFI_SECTION_PE32</code>, an <code>EFI_SECTION_VERSION</code>, and an <code>EFI_SECTION_DXE_DEPEX</code>.
While there is no version file defined in the INF - it has been specified by the
<code>VERSION</code> option; and there is a dependency file specified in the INF file&apos;s
source file list.</p>
<pre><code>DEFINE MMP_U_MT = MdeModulePkg/Universal/MemoryTest
INF VERSION = &quot;1.1&quot; $(MMP_U_MT)/NullMemoryTestDxe/NullMemoryTestDxe.inf
</code></pre><p>Valid options for the INF file line are:</p>
<p><strong><em>RuleOverride = RuleName</em></strong></p>
<p>This permits the platform integrator with a method to override the default
rules built into tools, specified in the <em>EDK II Build Specification</em> which
follows the UEFI and PI specifications for EFI FileType construction. If the
module is a binary module, the default rules are implied by the processor,
module type and <code>BINARY</code> rule name. Using the explicit named rule here may
compromise the platform&apos;s PI specification compliance. The <em>RuleName</em> is either
the reserved word, <code>BINARY</code> (that only applies to INF files that contain only
binary content), or the RuleUiName of a <code>[Rule]</code> section in this FDF file.</p>
<p><strong><em>USE = ARCH</em></strong></p>
<p>The <code>USE = ARCH</code> option is used to differentiate if a single INF file is built
different ways, for example a single INF file is called out multiple times in
the DSC file when building the same module for more than one processor
architecture.</p>
<p><strong><em>VERSION = &quot;String&quot;</em></strong></p>
<p>The <code>VERSION</code> option is used to create an <code>EFI_SECTION_VERSION</code> section with
the FFS file.</p>
<p><strong><em>UI = &quot;String&quot;</em></strong></p>
<p>The UI option is used to create an <code>EFI_SECTION_USER_INTERFACE</code> section for an
INF that may not have specified one.</p>
<p>When <code>RuleOverride</code> is not specified for binary module INF, <strong>GenFds</strong> tool
will find the FFS rule with <code>BINARY</code> rule name. If <code>RuleOverride</code> is specified,
<strong>GenFds</strong> tool will still find FFS rule with the specified rule name.</p>
<p>The following are examples of INF statements:</p>
<pre><code>DEFINE IFMP = IntelFrameworkModulePkg
INF USE = IA32 $(EDK_SOURCE)/Sample/Universal/Network/Ip4/Dxe/Ip4.inf
INF $(EDK_SOURCE)/Sample/Universal/Network/Ip4Config/Dxe/Ip4Config.inf
INF RULE_OVERRIDE = MyCompress $(IFMP)/Bus/Pci/IdeBusDxe/IdeBusDxe.inf
</code></pre><h3 id="256-file-statements">2.5.6 FILE Statements</h3>
<p><code>FILE</code> statements are provided so that a platform integrator can include
complete EFI FFS files, as well as a method for constructing FFS files using
curly &quot;{}&quot; brace scoping.</p>
<p>FFS file specification syntax is one of the following:</p>
<p><code>FILE Type $(NAMED_GUID) [Options] FileName</code></p>
<p>OR</p>
<pre><code class="lang-c">FILE Type $(NAMED_GUID) [Options] {
  SECTION SECTION_TYPE = FileName
  SECTION SECTION_TYPE = FileName
}
</code></pre>
<p>The first statement is commonly used with <code>EFI_FV_FILETYPE_RAW</code> files, while
the second type is used for most other file types. The <em>FileName</em> is typically
a binary file, and the consumer of this type of file must have an a priori
knowledge of the format.</p>
<p>The following describes the information that can be specified a File:</p>
<p><strong><em>Type</em></strong></p>
<p>EFI FV File Types - one and only one of the following:</p>
<ul>
<li><p><code>RAW</code> - Binary data</p>
</li>
<li><p><code>FREEFORM</code> - Sectioned binary data</p>
</li>
<li><p><code>SEC</code> - Sectioned data consisting of an optional pad section, a terse section
and an optional raw section.</p>
</li>
<li><p><code>PEI_CORE</code> - Sectioned data consisting of one PE32, one user interface and
one version section.</p>
</li>
<li><p><code>DXE_CORE</code> - Sectioned data containing one or more other sections.</p>
</li>
<li><p><code>PEIM</code> - Dispatched by PEI Core</p>
</li>
<li><p><code>DRIVER</code> - Dispatched by DXE core</p>
</li>
<li><p><code>COMBO_PEIM_DRIVER</code> - Combined PEIM/DXE driver containing PEI and DXE depex
sections as well as PE32 and version sections.<sup><a href="#fn_1" id="reffn_1">1</a></sup></p>
</li>
<li><p><code>SMM_CORE</code> - Sectioned data containing one or more other sections.</p>
</li>
<li><p><code>DXE_SMM_DRIVER</code> - Dispatched by the SMM Core</p>
</li>
<li><p><code>APPLICATION</code> - Application, so will not be dispatched</p>
</li>
<li><p><code>FV_IMAGE</code> - File contains an FV image</p>
</li>
<li><p><code>DISPOSABLE</code> - This section type is not supported by the EDK II build system</p>
</li>
<li><p><code>0x00 - 0xFF</code> - Hex values are legal too. See PI specification Volume 3 for
details</p>
</li>
</ul>
<p><strong><em>NAMED_GUID</em></strong></p>
<p>The <code>$(NAMED_GUID)</code> is usually constructed from an INF file&apos;s <code>[Defines]</code>
section <code>FILE_GUID</code> element.</p>
<p><strong><em>Options</em></strong></p>
<p>The <code>Fixed</code> and <code>Checksum</code> attributes are boolean flags, both default to
<code>FALSE,</code> specifying &quot;Fixed&quot; enables the flag to <code>TRUE</code>.</p>
<p>The Alignment attribute requires the &quot;= value&quot;.</p>
<ul>
<li><p><code>Fixed</code> - File can not be moved, default (not specified) is relocate-able.</p>
</li>
<li><p><code>Alignment</code> - Data (value is one of: 1, 2, 4, 8, 16, 32, 64, 128, 512, 1K, 2K,
4K, 8K, 16K, 32K, 64K, 128K, 256K, 512K, 1M, 2M, 4M, 8M, 16M) byte aligned</p>
</li>
<li><p><code>Checksum</code> - It is recommended that this be controlled on an entire FV basis
not at the file level, however, we are including this attribute for
completeness.</p>
</li>
</ul>
<p>UEFI and PI Specifications have rules for file type construction that, by
default, will be used by the tools.</p>
<p>In addition to the arguments on the <code>FILE</code> line, for EFI FV File types that are
not <code>RAW</code>, additional EFI section information must be specified.</p>
<p>To specify additional section information for a file, the EFI Encapsulation
Sections must be contained within curly &quot;{}&quot; braces that follow the <code>FILE</code>
line, while leaf sections are denoted by an <code>EFI_SECTION</code> type keyword.
Encapsulation and leaf section types are described below.</p>
<hr>
<p><strong>Caution:</strong> If a fully qualified path and filename are specified, the platform
integrator must ensure that all developers using the DSC and FDF file are aware
of the requirements for this path.</p>
<hr>
<p>The following is an example for using additional sections:</p>
<pre><code class="lang-c"><span class="hljs-meta">#Encapsulation - Compress</span>
FILE FOO = <span class="hljs-number">12345678</span><span class="hljs-number">-0000</span>-AAAA-FFFF<span class="hljs-number">-0123</span>ABCD12BD {
  SECTION COMPRESS {
    SECTION PE32 = $(WORKSPACE)/EdkModulePkg/Core/Dxe/DxeMain.inf
    SECTION VERSION = <span class="hljs-string">&quot;1.2.3&quot;</span>
  }
}

<span class="hljs-meta"># Encapsulation - GUIDED</span>
FILE FV_IMAGE = <span class="hljs-number">87654321</span>-FFFF-BBBB<span class="hljs-number">-2222</span><span class="hljs-number">-9874561230</span>AB {
  SECTION GUIDED gEfiTianoCompressionScheme {
    SECTION PE32 = $(WORKSPACE)/EdkModulePkg/Core/Dxe/DxeMain.inf
  }
}

<span class="hljs-meta"># LEAF Section</span>
FILE DXE_CORE = B5596C75<span class="hljs-number">-37</span>A2<span class="hljs-number">-4</span>b69-B40B<span class="hljs-number">-72</span>ABD6DD8708 {
  SECTION VERSION $(BUILD_DIR)/$(ARCH)/D6A2CB7F<span class="hljs-number">-6</span>A18<span class="hljs-number">-4E2</span>F-B43B<span class="hljs-number">-9920</span>A733700A-DxeMain.ver
}
</code></pre>
<blockquote id="fn_1">
<sup>1</sup>. The EDK II build system does not support creation of <code>COMBO_PEIM_DRIVER</code> FV type.<a href="#reffn_1" title="Jump back to footnote [1] in the text."> &#x21A9;</a>
</blockquote>
<h4 id="2561-efi-encapsulation-sections">2.5.6.1 EFI Encapsulation Sections</h4>
<p>There are two types of encapsulation sections, a <code>COMPRESSION</code> section and the
<code>GUIDED</code> section. The <code>DISPOSABLE</code> encapsulation section is not supported by
the EDK II build system.</p>
<p>The <code>COMPRESS</code> encapsulation section uses the following format.</p>
<pre><code class="lang-c">SECTION COMPRESS [type] {
  SECTION EFI_SECTION_TYPE = FILENAME
  SECTION EFI_SECTION_TYPE = <span class="hljs-string">&quot;string&quot;</span>
}
</code></pre>
<p>The <code>[type]</code> argument is optional, only <code>EFI_STANDARD_COMPRESSION</code> is supported
by the PI specification. The current EDK enumerations for compression are a
violation of the PI specification, and <code>SECTION GUIDED</code> must be used instead.</p>
<p>The <code>EFI_SECTION_TYPE</code> and <code>FILENAME</code> are required sub-elements within the
compression encapsulation section. for most sections. However both the
<code>VERSION</code> (<code>EFI_SECTION_VERSION</code>) and <code>UI</code> (<code>EFI_SECTION_USER_INTEFACE</code>) may
specify a string, that will be used to create an EFI section.</p>
<p>The <code>GUIDED</code> encapsulation section uses one of the following formats.</p>
<pre><code class="lang-c">SECTION GUIDED $(GUID_CNAME) [auth] {
  SECTION EFI_SECTION_TYPE = FILENAME
  SECTION EFI_SECTION_TYPE = <span class="hljs-string">&quot;string&quot;</span>
}

SECTION GUIDED $(GUID_CNAME) [auth] FILENAME
</code></pre>
<p>The required argument is the <code>GUIDED</code> name followed by an optional &quot;auth&quot;
flag. If the argument &quot;auth&quot; flag is specified, then the attribute
<code>EFI_GUIDED_SECTION_AUTH_STATUS_VALID</code> must be set.</p>
<p>For non-scoped statements (the second <code>SECTION</code> statement of the two listed
above,) if filename exists the Attribute
<code>EFI_GUIDED_SECTION_PROCESSING_REQUIRED</code> must be set to <code>TRUE</code>. The file
pointed to by filename is the data. If filename does not exist
<code>EFI_GUIDED_SECTION_PROCESSING_REQUIRED</code> is cleared and normal leaf sections
must be used.</p>
<h4 id="2562-efi-leaf-sections">2.5.6.2 EFI Leaf Sections</h4>
<p>Leaf sections are identified using the <code>EFI_SECTION</code> Type, as specified in the
UEFI specification. Arguments to the <code>EFI_SECTION</code> Type include information
that will be used to build a leaf section. Nesting of leaf sections within leaf
sections is not permitted, as a leaf section is defined as UEFI&apos;s smallest
entity.</p>
<p>The LEAF section is specified using the following format.</p>
<p><code>SECTION LEAF_SECTION [build #] [Align=X] [Unicode String][Filename]</code></p>
<p>The following keywords are used for valid <code>LEAF_SECTION</code> types.</p>
<ul>
<li><code>PE32</code></li>
<li><code>PIC</code></li>
<li><code>TE</code></li>
<li><code>DXE_DEPEX</code></li>
<li><code>SMM_DEPEX</code></li>
<li><code>PEI_DEPEX</code></li>
<li><code>VERSION</code> -- Contains either a 16-bit build number or a Unicode string</li>
<li><code>UI</code> -- Unicode String</li>
<li><code>COMPAT16</code></li>
<li><code>FV_IMAGE</code></li>
<li><code>SUBTYPE_GUID</code> -- A GUID value with content defined by the GUID to be used with
the section type of <code>EFI_SECTION_FREEFORM_SUBTYPE_GUID</code>.</li>
</ul>
<p>The argument, <code>build #</code>, is only valid for <code>VERSION</code> leaf section. The number
may be specified in the platform description (DSC) file&apos;s <code>[Defines]</code> section,
<code>BUILD_NUMBER</code> element. EDK INF files may specify a <code>BUILD_NUMBER</code> in the
defines section. However, this value is only used if the EDK II DSC file does
not contain a <code>BUILD_NUMBER</code> statement.</p>
<p>The <strong><em>Filename</em></strong> is only optional for <code>VERSION</code> and <code>UI</code>.</p>
<p>A Unicode string is only valid for <code>VERSION</code> or <code>UI</code> if the Filename is not
present, and is of the form <code>L&quot;string&quot;</code>.</p>
<p>The remaining leaf section types require the <strong><em>Filename</em></strong> argument. The file
must contain the data for the section.</p>

                                
                                </section>
                            
                        </div>
                    </div>
                    
                    

<div>
    <hr>
    
      <h2>
        <div style="position:absolute;text-align:left">EDK II Flash Description (FDF) File Specification</div>
        <div style="text-align:right">Revision 1.28.01</div>
      </h2>  
    
</div>



                
            </div>

            
                
                <a href="24_[fd]_sections.html#24-fd-sections" class="navigation navigation-prev " aria-label="Previous page: 2.4 [FD] Sections">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="26_[capsule]_sections.html#26-capsule-sections" class="navigation navigation-next " aria-label="Next page: 2.6 [Capsule] Sections">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"2.5 [FV] Sections","level":"1.3.5","depth":2,"next":{"title":"2.6 [Capsule] Sections","level":"1.3.6","depth":2,"anchor":"#26-capsule-sections","path":"2_fdf_design_discussion/26_[capsule]_sections.md","ref":"2_fdf_design_discussion/26_[capsule]_sections.md#26-capsule-sections","articles":[]},"previous":{"title":"2.4 [FD] Sections","level":"1.3.4","depth":2,"anchor":"#24-fd-sections","path":"2_fdf_design_discussion/24_[fd]_sections.md","ref":"2_fdf_design_discussion/24_[fd]_sections.md#24-fd-sections","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{"title":"EDK II Flash Description (FDF) File Specification","version":"Revision 1.28.01"},"plugins":["puml-aleung"],"pluginsConfig":{"puml-aleung":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css","website":"styles/website.css"}},"file":{"path":"2_fdf_design_discussion/25_[fv]_sections.md","mtime":"2025-04-28T23:01:34.523Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2025-04-28T23:02:02.194Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

